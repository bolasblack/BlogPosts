--- 
title: "å®šåˆ¶ä½ çš„ zsh å‘½ä»¤æç¤ºç¬¦"
category: ["Linux"]
tags: ["zsh", "å‘½ä»¤æç¤ºç¬¦"]
---

å®˜æ–¹æ–‡æ¡£åœ°å€ï¼š<a href="http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html">http://zsh.sourceforge.net/Doc/Release/Prompt-Expansion.html</a>

æˆ‘è‡ªå·±çš„å‘½ä»¤æç¤ºç¬¦

```bash
PROMPT='%B%{[32m%}%n%(?. . %{[31m%}%? )%{[m%}> %{[1;34m%}%~ %{[m%}%# %b'
```

å†æŠŠç¿»è¯‘çš„æ–‡ç« è´´å‡ºæ¥ï¼Œæ–‡ä¸­æœ‰ä¸€éƒ¨åˆ†å¯èƒ½æ²¡æœ‰ç¿»è¯‘ï¼Œé‚£ä¸ªä¹Ÿè¯·è§è°…&hellip;&hellip;

<article>
<h2>æœ‰å…³æç¤ºç¬¦çš„è‰²å½©</h2>

zshé‡Œç€è‰²éœ€è¦åœ¨è½¬ä¹‰å­—ç¬¦/æ™®é€šå­—ç¬¦å‰å¡«å…¥ï¼š

```bash
%{^[[<è‰²å½©ç¼–å·>m%}</pre>
```

å…¶ä¸­ `^[` éœ€è¦ Vim åœ¨æ’å…¥æ¨¡å¼ä¸‹æŒ‰ä¸‹ <kbd>Ctrl+v</kbd> <kbd>Esc</kbd> æ‰èƒ½è¾“å…¥ï¼Œå¦‚æœæ²¡æœ‰è¾“å…¥è‰²å½©çš„ç¼–å·ï¼Œé‚£ä¹ˆå°±æ˜¯é»˜è®¤è‰²å½©

è‰²å½©ç¼–å·å¦‚ä¸‹ï¼š

<table>
<tr><td>Black 0;30</td><td>Dark Gray 1;30</td></tr>
<tr><td>Blue 0;34</td><td>Light Blue 1;34</td></tr>
<tr><td>Green 0;32</td><td>Light Green 1;32</td></tr>
<tr><td>Cyan 0;36</td><td>Light Cyan 1;36</td></tr>
<tr><td>Red 0;31</td><td>Light Red 1;31</td></tr>
<tr><td>Purple 0;35</td><td>Light Purple 1;35</td></tr>
<tr><td>Brown 0;33</td><td>Yellow 1;33</td></tr>
<tr><td>Light Gray 1;37</td><td>White 1;37</td></tr>
</table>

<h2>æç¤ºç¬¦ä»‹ç»</h2>

</h4>Special characters</h4>
<table>
<tr><td>%%</td><td>ä¸€ä¸ª'%'</td></tr>
<tr><td>#%)</td><td>ä¸€ä¸ª')'</td></tr>
</table>

<h4>Login information</h4>
<table>
<tr><td>%y</td><td>å½“å‰çš„ttyå</td></tr>
<tr><td>%l</td><td>å½“å‰çš„ttyåï¼Œå¦‚ pts/1 </td></tr>
<tr><td>%M</td><td>å®Œæ•´ä¸»æœºå</td></tr>
<tr><td>%m</td><td>ä¸»æœºåï¼ˆåœ¨ç¬¬ä¸€ä¸ªå¥å·ä¹‹å‰æˆªæ–­ï¼‰</td></tr>
<tr><td>%n</td><td>å½“å‰ç”¨æˆ·å</td></tr>
</table>

<h4>Shell state</h4>
<table>
<tr><td>%. %c %C</td><td> å‰ä¸¤ä¸ªæ˜¾ç¤ºç›¸å¯¹è·¯å¾„çš„å½“å‰æ–‡ä»¶å¤¹åï¼Œæœ€åä¸€ä¸ªæ˜¯ç»å¯¹è·¯å¾„ï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œå‰ä¸¤ä¸ªåœ¨å®¶ç›®å½•ä¸‹æ˜¾ç¤º'~'ï¼Œæœ€åé‚£ä¸ªæ˜¾ç¤ºä½ çš„ç”¨æˆ·åï¼‰ï¼Œ'%'åçš„æ•°å­—è¡¨ç¤ºæ˜¾ç¤ºå‡ å±‚è·¯å¾„</td></tr>
<tr><td>%N</td><td>zsh æ­£åœ¨æ‰§è¡Œçš„è„šæœ¬/å‡½æ•°åã€‚å¦‚æœ'%'åè·Ÿäº†æ•°å­—ï¼Œä¼¼ä¹è¿˜æœ‰å…¶ä»–ä½œç”¨</td></tr>
<tr><td>%L</td><td>å½“å‰shellçš„å±‚æ•°ï¼Œå¯ä»¥å‚è€ƒã€Šç›—æ¢¦ç©ºé—´ã€‹çš„å±‚æ•°</td></tr>
<tr><td>%j</td><td>å½“å‰æ­£åœ¨è¿›è¡Œçš„å·¥ä½œæ•°é‡</td></tr>
<tr><td>%i</td><td>ä¸%!ç±»ä¼¼ï¼šThe line number currently being executed in the script, sourced file, or shell function given by %N. This is most useful for debugging as part of $PS4.</td></tr>
<tr><td>%!</td><td>æ˜¾ç¤ºå½“å‰å†å²äº‹ä»¶å·ç ï¼ˆä¹Ÿå°±æ˜¯æ‰“å¼€shellåç¬¬å‡ æ¡å‘½ä»¤ï¼‰</td></tr>
<tr><td>%/ %d</td><td>æ˜¾ç¤ºå½“å‰å·¥ä½œè·¯å¾„ï¼ˆ$pwdï¼‰ã€‚å¦‚æœ'ï¼…'åé¢æ˜¯ä¸€ä¸ªæ•´æ•°ï¼Œå®ƒæŒ‡å®šæ˜¾ç¤ºè·¯å¾„çš„å…ƒä»¶çš„æ•°é‡;æ²¡æœ‰æ•°å­—å°±æ˜¾ç¤ºæ•´ä¸ªè·¯å¾„ã€‚ä¸€ä¸ªè´Ÿæ•´æ•°å°±æ˜¯æŒ‡å®šä¸»ç›®å½•ï¼Œå³ï¼…-1dä»£è¡¨ç¬¬ä¸€éƒ¨åˆ†</td></tr>
<tr><td>%~</td><td>ç›®å‰çš„å·¥ä½œç›®å½•ç›¸å¯¹äºï½çš„ç›¸å¯¹è·¯å¾„</td></tr>
<tr><td>`%_`</td><td>The status of the parser, i.e. the shell constructs (like `if` and `for`) that have been started on the command line. If given an integer number that many strings will be printed; zero or negative or no integer means print as many as there are. This is most useful in prompts PS2 for continuation lines and PS4 for debugging with the XTRACE option; in the latter case it will also work non-interactively.</td></tr>
<tr><td>%?</td><td>è¿”å›æœ€åå‘½ä»¤çš„æ‰§è¡Œç»“æœçš„ä»£ç </td></tr>
<tr><td>%#</td><td>ç”¨æˆ·ç»„ï¼Œ#ï¼ˆæ™®é€šç”¨æˆ·ï¼‰/%ï¼ˆè¶…çº§ç”¨æˆ·ï¼‰</td></tr>
</table>

<h4>Date and time</h4>
<table>
<tr><td>%D{}</td><td>æ ¼å¼åŒ–æ—¥æœŸï¼Œå†…å®¹åœ¨ä¸‹ï¼š<br />
  %f %e ï¼šå½“æœˆæ—¥æœŸ (å¦‚æœæ˜¯ä¸ªä½æ•°çš„è¯ï¼Œç¬¬äºŒä¸ªæ¯”ç¬¬ä¸€ä¸ªå¤šä¸€ä¸ªå ä½ç¬¦ï¼ˆä¸€ä¸ªç©ºæ ¼ï¼‰<br />
  %K %k ï¼š24å°æ—¶åˆ¶ï¼Œç¬¬äºŒä¸ªæ¯”ç¬¬ä¸€ä¸ªå¤šå ä½ç¬¦<br />
  %L %l ï¼š12å°æ—¶åˆ¶ï¼Œç¬¬äºŒä¸ªæ¯”ç¬¬ä¸€ä¸ªå¤šå ä½ç¬¦</td></tr>
<tr><td>%W</td><td>ç³»ç»Ÿæ—¥æœŸ (æœˆ-æ—¥-å¹´)</td></tr>
<tr><td>%w</td><td>ç³»ç»Ÿæ—¥æœŸ (å‘¨å‡  æ—¥æœŸ)</td></tr>
<tr><td>%D</td><td>ç³»ç»Ÿæ—¥æœŸï¼ˆå¹´-æœˆ-æ—¥ï¼‰</td></tr>
<tr><td>%T</td><td>ç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶ï¼šåˆ†ï¼‰ï¼Œ24å°æ—¶åˆ¶</td></tr>
<tr><td>%t %@</td><td>ç³»ç»Ÿæ—¶é—´ï¼Œ12å°æ—¶åˆ¶</td></tr>
<tr><td>`%*`</td><td>ç³»ç»Ÿæ—¶é—´ï¼ˆæ—¶ï¼šåˆ†ï¼šç§’ï¼‰</td></tr>
</table>

<h4>Visual effects</h4>
<table>
<tr><td>%B(%b)</td><td>å¼€å§‹åˆ°ç»“æŸä½¿ç”¨ç²—ä½“æ‰“å°</td></tr>
<tr><td>%U(%u)</td><td>å¼€å§‹åˆ°ç»“æŸä½¿ç”¨ä¸‹åˆ’çº¿æ‰“å°</td></tr>
<tr><td>%S(%s)</td><td>å¼€å§‹åˆ°ç»“æŸä½¿ç”¨çªå‡ºæ¨¡å¼æ‰“å°</td></tr>
<tr><td>%{..%}</td><td>å¯ä»¥è¾“å…¥ä¸€äº›è½¬ä¹‰å­—ç¬¦ï¼ŒèŠ±æ‹¬å·é‡Œçš„å†…å®¹ä¸ä¼šæ”¹å˜å…‰æ ‡ä½ç½®ï¼ŒèŠ±æ‹¬å·å¯ä»¥åµŒå¥—</td></tr>
<tr><td>%E</td><td>æ¸…ç©ºä¸€è¡Œ</td></tr>
</table>

<h4>Conditional substrings</h4>

* `%v` ï¼šè·å– psvar æ•°ç»„çš„ç¬¬ä¸€ä¸ªå€¼ï¼Œ&rsquo;%&lsquo;åæ˜¯ä»€ä¹ˆæ•°å­—å°±è¿”å›ç¬¬å‡ ä¸ªå€¼ï¼Œè´Ÿæ•°å°±è¿”å›å€’æ•°è¿‡å»çš„å€¼
* `%(x.true-text.false-text)` ï¼šè¿™æ˜¯ä¸€ä¸ªåˆ¤æ–­å¼ï¼Œåˆ¤æ–­ x çš„çœŸå‡ï¼ŒçœŸåˆ™è¾“å‡º true-text ï¼Œå¦åˆ™è¾“å‡º false-text
å·¦ä¾§æ‹¬å·å‰åå¯ä»¥æ’å…¥ä¸€ä¸ªæ­£æ•°nï¼Œå¦‚æœæ˜¯è´Ÿæ•°çš„è¯å°±ä¼šè¢«ä¹˜ä»¥ -1ï¼Œnåœ¨ä¸‹æ–‡ä¼šç”¨åˆ°
x æœ‰ä»¥ä¸‹å†…å®¹ï¼š

<table>
<tr><td> ! </td><td>æ˜¯å¦æ˜¯rootæƒé™</td></tr>
<tr><td> # </td><td>å½“å‰è¿›ç¨‹çš„UIDæ˜¯å¦ç­‰äºn</td></tr>
<tr><td> g </td><td>å½“å‰è¿›ç¨‹çš„æœ‰æ•ˆGIDæ˜¯å¦ç­‰äºn</td></tr>
<tr><td> ? </td><td>æœ€åå‘½ä»¤çš„è¿”å›å€¼æ˜¯å¦ç­‰äºn</td></tr>
<tr><td> _ </td><td>å½“å‰æ˜¯å¦æœ‰è‡³å°‘nä¸ªshell constructsæ­£åœ¨æ‰§è¡Œ</td></tr>
<tr><td> C / </td><td>å½“å‰çš„ç»å¯¹è·¯å¾„æ˜¯å¦è‡³å°‘æœ‰nä¸ªå…ƒç´ </td></tr>
<tr><td> c . ~ </td><td>å½“å‰è·¯å¾„è·ç¦»æ ¹ç›®å½•(/)æ˜¯å¦è‡³å°‘æœ‰nä¸ªå…ƒç´ ï¼Œ/ç®—æ˜¯0 </td></tr>
<tr><td> D </td><td>å½“å‰æœˆä»½æ˜¯å¦ç­‰äºnï¼Œ1æœˆç­‰äº0</td></tr>
<tr><td> d </td><td>å½“å‰æ—¥æœŸæ˜¯å¦ç­‰äºn</td></tr>
<tr><td> j </td><td>å½“å‰ä½œä¸šæ•°æ˜¯å¦ç­‰äºn</td></tr>
<tr><td> L </td><td>å½“å‰shellå±‚æ•°æ˜¯å¦ç­‰äºn</td></tr>
<tr><td> l </td><td>å½“å‰æ˜¯å¦å·²ç»è‡³å°‘æœ‰nä¸ªå­—ç¬¦å·²ç»æ‰“å°</td></tr>
<tr><td> S </td><td>å½“å‰çš„ç§’æ•°æ˜¯å¦è‡³å°‘ä¸ºn</td></tr>
<tr><td> T </td><td>å½“å‰å°æ—¶æ˜¯å¦ç­‰äºn</td></tr>
<tr><td> t </td><td>å½“å‰çš„åˆ†é’Ÿæ˜¯å¦ç­‰äºn</td></tr>
<tr><td> v </td><td>å½“å‰ psvar æ•°ç»„æ˜¯å¦å·²ç»è‡³å°‘æœ‰nä¸ªå…ƒç´ </td></tr>
<tr><td> w </td><td>æ˜¯å¦ç­‰äºå‘¨nï¼Œå‘¨æ—¥æ˜¯0</td></tr>
</table>

<blockquote>
%&lt;string&lt;<br/>
%&gt;string&gt;<br/>
%[xstring]<br/>
Specifies truncation behaviour for the remainder of the prompt string. The '<'. The numeric argument, which in the third form may appear immediately after the '[', specifies the maximum permitted length of the various strings that can be displayed in the prompt. The string will be displayed in place of the truncated portion of any string; note this does not undergo prompt expansion.<br/>
<br/>
The forms with '<' truncate at the left of the string, and the forms with '>' truncate at the right of the string. For example, if the current directory is '/home/pike', the prompt '%8<..<%/' will expand to '..e/pike'. In this stfing, the terminating character ('<', '>' or ']'), or in fact any character, may be quoted by a preceding '\'; note when using print -P, however, that this must be doubled as the string is also subject to standard print processing, in addition to any backslashes removed by a double quoted string: the worst case is therefore 'print -P "%<\\\\<<..."'.<br/>
<br/>
If the string is longer than the specified truncation length, it will appear in full, completely replacing the truncated string.<br/>
<br/>
The part of the prompt string to be truncated runs to the end of the string, or to the end of the next enclosing group of the '%(' construct, or to the next truncation encountered at the same grouping level (i.e. truncations inside a '%(' are separate), which ever comes first. In particular, a truncation with argument zero (e.g. '%<<') marks the end of the range of the string to be truncated while turning off truncation from there on. For example, the prompt '%10<...<%~%<<%# ' will print a truncated representation of the current directory, followed by a '%' or '#', followed by a space. Without the '%<<', those two characters would be included in the string to be truncated.
</blockquote>

</article>
